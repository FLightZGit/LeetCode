dont use poll.size() directly in the for loop, it will change every time the queue size changed